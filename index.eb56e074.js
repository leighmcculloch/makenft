!function(e,t,n,r,o){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof i.parcelRequire9328&&i.parcelRequire9328,s=a.cache||{},u="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function d(t,n){if(!s[t]){if(!e[t]){var r="function"==typeof i.parcelRequire9328&&i.parcelRequire9328;if(!n&&r)return r(t,!0);if(a)return a(t,!0);if(u&&"string"==typeof t)return u(t);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}c.resolve=function(n){var r=e[t][1][n];return null!=r?r:n},c.cache={};var l=s[t]=new d.Module(t);e[t][0].call(l.exports,c,l,l.exports,this)}return s[t].exports;function c(e){var t=c.resolve(e);return!1===t?{}:d(t)}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=e,d.cache=s,d.parent=a,d.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(d,"root",{get:function(){return i.parcelRequire9328}}),i.parcelRequire9328=d;for(var l=0;l<t.length;l++)d(t[l]);var c=d(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd&&define((function(){return c}))}({ep5eR:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js"),o=e("stellar-sdk"),i=r.interopDefault(o),a=e("array-buffer-to-hex"),s=r.interopDefault(a),u=e("ipfs-core"),d=e("./config.js"),l=e("./wallet-freighter.js");function c(){const e=document.getElementById("network").value;return d.getConfig(e)}function f(e){return async()=>{try{await e()}catch(e){throw function(e){const t=document.getElementById("result");t.innerText=e.toString(),t.classList.remove("d-none"),t.classList.remove("alert-success"),t.classList.add("alert-danger")}(e.error||e),document.getElementById("create-button").removeAttribute("disabled"),document.getElementById("view-button").removeAttribute("disabled"),e}}}function p(){const e=document.getElementById("result");e.innerText="",e.classList.add("d-none")}async function E(){const e=document.getElementById("wallet-button");l.isConnected()?(l.getNetwork().then((e=>{null!==e&&(document.getElementById("network").value=e)})),e.classList.add("d-none"),document.getElementById("create-button").classList.add("d-block"),document.getElementById("view-button").classList.add("d-block")):(e.innerText="Add the Freighter extension to Chrome",window.setTimeout(E,500))}window.init=f(E),window.add=f((async function(){E(),l.isConnected()||window.open("https://freighter.app","_blank","noopener")})),window.create=f((async function(){p(),document.getElementById("create-button").setAttribute("disabled","disabled"),document.getElementById("view-button").setAttribute("disabled","disabled");const{code:e,issuer:t,xdr:n}=await y(),r=await l.signTransaction(n,c().network);console.log(`Transaction signed: ${r}`);const o=i.default.TransactionBuilder.fromXDR(r,c().networkPassphrase),a=await c().horizonServer.submitTransaction(o);console.log(a),function(e){const t=document.getElementById("result");t.innerHTML=e,t.classList.remove("d-none"),t.classList.remove("alert-danger"),t.classList.add("alert-success")}(`ðŸŽ‰ View your NFT <a href="${c().viewUrl(e,t)}">here</a>.`),document.getElementById("create-button").removeAttribute("disabled"),document.getElementById("view-button").removeAttribute("disabled")})),window.view=f((async function(){p(),document.getElementById("create-button").setAttribute("disabled","disabled"),document.getElementById("view-button").setAttribute("disabled","disabled");const{xdr:e}=await y(),t=`https://laboratory.stellar.org/#xdr-viewer?type=TransactionEnvelope&input=${encodeURIComponent(e)}`;window.open(t,"_blank","noopener"),document.getElementById("create-button").removeAttribute("disabled"),document.getElementById("view-button").removeAttribute("disabled")})),window.upload=f((async function(){const e=document.getElementById("file-upload"),t=document.getElementById("file-label");t.innerText="";const n=document.getElementById("file-preview-group"),r=document.getElementById("file-preview");for(;r.firstChild;)r.removeChild(r.firstChild);if(e.files.length>0){const o=e.files[0],i=e.value.replace("C:\\fakepath\\",""),a=o.size/1024;t.innerText=`${i} (${a} KB)`;const s=window.URL.createObjectURL(o),u=document.createElement("img");u.src=s,r.appendChild(u),n.classList.remove("d-none")}else n.classList.add("d-none")}));let T=null;async function m(){return null!==T||(T=await u.create()),T}async function y(){const e=document.getElementById("code").value,t=document.getElementById("quantity").value,n=document.getElementById("file-upload"),r=document.getElementById("description").value;let o=[],a=null;if(n.files.length>0){const e=n.files[0],t=await new Promise(((t,n)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=e=>n(e),r.readAsArrayBuffer(e)})),r=await m(),{cid:i}=await r.add(t);o=`ipfs://${i.string}`,a=await crypto.subtle.digest("SHA-256",t)}const u=i.default.Keypair.random();let d=null,f=null,p=null;if(r.length>0){const t={name:e,description:r,url:o,sha256:s.default(a),issuer:u.publicKey(),code:e},n=JSON.stringify(t,null,"\t"),i=(new TextEncoder).encode(n),l=await m(),{cid:c}=await l.add(i);d=c.string;f=`ipfs://${c.string}`.match(/.{1,64}/g),p=await crypto.subtle.digest("SHA-256",i)}const E=new i.default.Asset(e,u.publicKey()),T=await l.getPublicKey(),y=await(async()=>{try{return await c().horizonServer.loadAccount(T)}catch{throw new Error(`Your account ${T} does not exist on the Stellar ${c().network} network. It must be created before it can be used to submit transactions.`)}})(),w=await c().horizonServer.fetchBaseFee(),g=new i.default.TransactionBuilder(y,{fee:w,networkPassphrase:c().networkPassphrase});if(g.setTimeout(300),g.addMemo(i.default.Memo.text(`Create ${e} NFT âœ¨`)),g.addOperation(i.default.Operation.beginSponsoringFutureReserves({sponsoredId:u.publicKey()})),g.addOperation(i.default.Operation.createAccount({destination:u.publicKey(),startingBalance:"0"})),g.addOperation(i.default.Operation.manageData({source:u.publicKey(),name:"ipfshash",value:d})),1==f.length)g.addOperation(i.default.Operation.manageData({source:u.publicKey(),name:"url",value:f[0]}));else for(let e=0;e<f.length;e++)g.addOperation(i.default.Operation.manageData({source:u.publicKey(),name:`url[${e}]`,value:f[e]}));p&&g.addOperation(i.default.Operation.manageData({source:u.publicKey(),name:"sha256",value:s.default(p)})),g.addOperation(i.default.Operation.endSponsoringFutureReserves({source:u.publicKey()})),g.addOperation(i.default.Operation.changeTrust({asset:E,limit:t})),g.addOperation(i.default.Operation.payment({source:u.publicKey(),destination:T,asset:E,amount:t})),g.addOperation(i.default.Operation.setOptions({source:u.publicKey(),masterWeight:0}));const b=g.build();b.sign(u);const C=b.toEnvelope().toXDR("base64");return console.log(`Transaction built: ${C}`),{code:e,issuer:u.publicKey(),xdr:C}}E()},{"stellar-sdk":"9AhoN","array-buffer-to-hex":"1LeKs","ipfs-core":"egrwM","./config.js":"4O8Xx","./wallet-freighter.js":"cibyt","@parcel/transformer-js/src/esmodule-helpers.js":"qayoQ"}],"1LeKs":[function(e,t,n){t.exports=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.byteLength)throw new TypeError("Expected input to be an ArrayBuffer");for(var t,n=new Uint8Array(e),r="",o=0;o<n.length;o++)r+=1===(t=n[o].toString(16)).length?"0"+t:t;return r}},{}],cibyt:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"isConnected",(()=>a)),r.export(n,"getNetwork",(()=>s)),r.export(n,"getPublicKey",(()=>u)),r.export(n,"signTransaction",(()=>d));var o=e("@stellar/freighter-api"),i=r.interopDefault(o);function a(){return i.default.isConnected()}async function s(){switch(await i.default.getNetwork()){case"TESTNET":return"testnet";case"PUBLIC":return"pubnet"}return null}async function u(){return await i.default.getPublicKey()}async function d(e,t){let n;switch(t){case"testnet":n="TESTNET";break;case"pubnet":n="PUBLIC";break;default:throw`Network '${t} unsupported by Freighter. Only pubnet and testnet are supported.`}return await i.default.signTransaction(e,n)}},{"@stellar/freighter-api":"krolK","@parcel/transformer-js/src/esmodule-helpers.js":"qayoQ"}],krolK:[function(e,t,n){var r,o;r=this,o=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r,o,i,a,s;n.r(t),(i=r||(r={})).CREATE_ACCOUNT="CREATE_ACCOUNT",i.FUND_ACCOUNT="FUND_ACCOUNT",i.ADD_ACCOUNT="ADD_ACCOUNT",i.IMPORT_ACCOUNT="IMPORT_ACCOUNT",i.LOAD_ACCOUNT="LOAD_ACCOUNT",i.MAKE_ACCOUNT_ACTIVE="MAKE_ACCOUNT_ACTIVE",i.UPDATE_ACCOUNT_NAME="UPDATE_ACCOUNT_NAME",i.GET_MNEMONIC_PHRASE="GET_MNEMONIC_PHRASE",i.CONFIRM_MNEMONIC_PHRASE="CONFIRM_MNEMONIC_PHRASE",i.RECOVER_ACCOUNT="RECOVER_ACCOUNT",i.CONFIRM_PASSWORD="CONFIRM_PASSWORD",i.REJECT_ACCESS="REJECT_ACCESS",i.GRANT_ACCESS="GRANT_ACCESS",i.SIGN_TRANSACTION="SIGN_TRANSACTION",i.REJECT_TRANSACTION="REJECT_TRANSACTION",i.SIGN_OUT="SIGN_OUT",i.SHOW_BACKUP_PHRASE="SHOW_BACKUP_PHRASE",i.SAVE_SETTINGS="SAVE_SETTINGS",i.LOAD_SETTINGS="LOAD_SETTINGS",i.GET_CACHED_ASSET_ICON="GET_CACHED_ASSET_ICON",i.CACHE_ASSET_ICON="CACHE_ASSET_ICON",function(e){e.REQUEST_ACCESS="REQUEST_ACCESS",e.SUBMIT_TRANSACTION="SUBMIT_TRANSACTION",e.REQUEST_NETWORK="REQUEST_NETWORK"}(o||(o={})),function(e){e.TESTNET="Test network",e.PUBNET="Public network"}(a||(a={})),function(e){e.PUBLIC="PUBLIC",e.TESTNET="TESTNET"}(s||(s={}));class u extends Error{constructor(){super(...arguments),this.message="Freighter does not appear to be installed."}}const d=e=>{const t=Date.now()+Math.random();return window.postMessage({source:"FREIGHTER_EXTERNAL_MSG_REQUEST",messageId:t,...e},window.location.origin),new Promise(((e,n)=>{window.freighter||n(new u);const r=n=>{var o,i;n.source===window&&"FREIGHTER_EXTERNAL_MSG_RESPONSE"===(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.source)&&(null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.messagedId)===t&&(e(n.data),window.removeEventListener("message",r))};window.addEventListener("message",r,!1)}))},l=()=>(async()=>{let e={publicKey:"",error:""};try{e=await d({type:o.REQUEST_ACCESS})}catch(e){console.error(e)}const{publicKey:t,error:n}=e;if(n)throw n;return t})(),c=(e,t)=>(async(e,t)=>{let n={signedTransaction:"",error:""};if(t&&t!==s.PUBLIC&&t!==s.TESTNET)throw`Network must be ${s.PUBLIC} or ${s.TESTNET}`;try{n=await d({transactionXdr:e,network:t,type:o.SUBMIT_TRANSACTION})}catch(e){console.error(e)}const{signedTransaction:r,error:i}=n;if(i)throw i;return r})(e,t),f=()=>!!window.freighter,p=()=>(async()=>{let e={network:"",error:""};try{e=await d({type:o.REQUEST_NETWORK})}catch(e){console.error(e)}const{network:t,error:n}=e;if(n)throw n;return t})();n.d(t,"getPublicKey",(function(){return l})),n.d(t,"signTransaction",(function(){return c})),n.d(t,"isConnected",(function(){return f})),n.d(t,"getNetwork",(function(){return p})),t.default={getPublicKey:l,signTransaction:c,isConnected:f,getNetwork:p}}])},"object"==typeof n&&"object"==typeof t?t.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof n?n.freighterApi=o():r.freighterApi=o()},{}]},["ep5eR"],"ep5eR");
//# sourceMappingURL=index.eb56e074.js.map
